<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>2. Analyze trajectories of DDEGs. â€¢ TrendCatcher</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="2. Analyze trajectories of DDEGs.">
<meta property="og:description" content="TrendCatcher">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">TrendCatcher</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Compare-Curve-Permutation.html">4.Compare a biological pathway temporal behavior between two groups</a>
    </li>
    <li>
      <a href="../articles/Gene-Trajectory-Analysis.html">2. Analyze trajectories of DDEGs.</a>
    </li>
    <li>
      <a href="../articles/Identify-Dynamic-Genes.html">1. Identify dynamic differentially expressed genes (DDEGs) and generate master.list object</a>
    </li>
    <li>
      <a href="../articles/Time-Heatmap-GO.html">3. Generate TimeHeatmap</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>2. Analyze trajectories of DDEGs.</h1>
            
      
      
      <div class="hidden name"><code>Gene-Trajectory-Analysis.Rmd</code></div>

    </div>

    
    
<div class="section level4">
<h4 id="load-trendcatcher-r-package-">1. Load TrendCatcher R package.<a class="anchor" aria-label="anchor" href="#load-trendcatcher-r-package-"></a>
</h4>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">TrendCatcher</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="now-read-the-demo-master-list-">2. Now read the demo master.list.<a class="anchor" aria-label="anchor" href="#now-read-the-demo-master-list-"></a>
</h4>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">demo.master.list.path</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"BrainMasterList.rda"</span>, package <span class="op">=</span> <span class="st">"TrendCatcher"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/load.html" class="external-link">load</a></span><span class="op">(</span><span class="va">demo.master.list.path</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="id-convention-">3. ID convention.<a class="anchor" aria-label="anchor" href="#id-convention-"></a>
</h4>
<p>The demo master table is using gene ENSEMBL as row name. For input CSV file using ENSEMBL ID as row name. TrendCatcher provides some easy manipulation functions to add gene SYMBOL column into the master.table.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">### In case bioMart has connection issue, you can load from example data</span></span>
<span></span>
<span><span class="co">#gene.symbol.df&lt;-get_GeneEnsembl2Symbol(ensemble.arr = master.list$master.table$Gene)</span></span>
<span><span class="co">#master.table.new&lt;-cbind(master.list$master.table, gene.symbol.df[match(master.list$master.table$Gene, gene.symbol.df$Gene), c("Symbol", "description")])</span></span>
<span><span class="co">#master.list$master.table&lt;-master.table.new</span></span>
<span><span class="co">#head(master.list$master.table)</span></span>
<span></span>
<span><span class="va">demo.master.list.path</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"BrainMasterList_Symbol.rda"</span>, package <span class="op">=</span> <span class="st">"TrendCatcher"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/load.html" class="external-link">load</a></span><span class="op">(</span><span class="va">demo.master.list.path</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">master.list</span><span class="op">$</span><span class="va">master.table</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##                    Gene  pattern start.idx end.idx     dynTime  dynSign start.t</span></span>
<span><span class="co">## 1330 ENSMUSG00000025283 up_down_      1_4_    4_6_ 6_24_48_72_ +_+_+_+_   0_48_</span></span>
<span><span class="co">## 1857 ENSMUSG00000028967 up_down_      1_2_    2_6_    6_24_48_   +_+_+_    0_6_</span></span>
<span><span class="co">## 2886 ENSMUSG00000039236 up_down_      1_2_    2_6_       6_24_     +_+_    0_6_</span></span>
<span><span class="co">## 4179 ENSMUSG00000078920 up_down_      1_2_    2_6_    6_24_48_   +_+_+_    0_6_</span></span>
<span><span class="co">## 4437 ENSMUSG00000105987 up_down_      1_4_    4_6_ 6_24_48_72_ +_+_+_+_   0_48_</span></span>
<span><span class="co">## 973  ENSMUSG00000022221 up_down_      1_3_    3_6_ 6_24_48_72_ +_+_+_+_   0_24_</span></span>
<span><span class="co">##        end.t         pattern_str dyn.p.val dyn.p.val.adj   Symbol</span></span>
<span><span class="co">## 1330 48_168_ 0h_up_48h_down_168h  1.11e-16  4.615657e-13     Sat1</span></span>
<span><span class="co">## 1857  6_168_  0h_up_6h_down_168h  1.11e-16  4.615657e-13   Errfi1</span></span>
<span><span class="co">## 2886  6_168_  0h_up_6h_down_168h  1.11e-16  4.615657e-13    Isg20</span></span>
<span><span class="co">## 4179  6_168_  0h_up_6h_down_168h  1.11e-16  4.615657e-13    Ifi47</span></span>
<span><span class="co">## 4437 48_168_ 0h_up_48h_down_168h  2.22e-16  7.385052e-13 AI506816</span></span>
<span><span class="co">## 973  24_168_ 0h_up_24h_down_168h  3.33e-16  9.231315e-13    Ripk3</span></span>
<span><span class="co">##                                                                             description</span></span>
<span><span class="co">## 1330      spermidine/spermine N1-acetyl transferase 1 [Source:MGI Symbol;Acc:MGI:98233]</span></span>
<span><span class="co">## 1857             ERBB receptor feedback inhibitor 1 [Source:MGI Symbol;Acc:MGI:1921405]</span></span>
<span><span class="co">## 2886                  interferon-stimulated protein [Source:MGI Symbol;Acc:MGI:1928895]</span></span>
<span><span class="co">## 4179            interferon gamma inducible protein 47 [Source:MGI Symbol;Acc:MGI:99448]</span></span>
<span><span class="co">## 4437                    expressed sequence AI506816 [Source:MGI Symbol;Acc:MGI:2140929]</span></span>
<span><span class="co">## 973  receptor-interacting serine-threonine kinase 3 [Source:MGI Symbol;Acc:MGI:2154952]</span></span></code></pre>
<p>If the input CSV file using GENE SYMBOL as row name. Just simply add Symbol column to the master.table. Because some function requires the Symbol column.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">### ONLY use this command if CSV file is using GENE SYMBOL as row name!!!!!!</span></span>
<span><span class="co">#master.list$master.table$Symbol&lt;-master.list$master.table$Gene </span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="plot-individual-gene-trajectory">4. Plot Individual Gene Trajectory<a class="anchor" aria-label="anchor" href="#plot-individual-gene-trajectory"></a>
</h4>
<p>To look at each single gene trajectory and fitted count. We use function draw_GeneTraj.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gene.symbol.arr</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">master.list</span><span class="op">$</span><span class="va">master.table</span><span class="op">$</span><span class="va">Symbol</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span></span>
<span><span class="va">p</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/draw_GeneTraj.html">draw_GeneTraj</a></span><span class="op">(</span>master.list <span class="op">=</span> <span class="va">master.list</span>, gene.symbol.arr <span class="op">=</span> <span class="va">gene.symbol.arr</span>, ncol <span class="op">=</span> <span class="fl">3</span>, nrow <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">p</span></span></code></pre></div>
<p><img src="Gene-Trajectory-Analysis_files/figure-html/unnamed-chunk-5-1.png" width="960"> #### 5. Plot Gene Trajectories grouped by their sub-type trajectory pattern.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/draw_TrajClusterGrid.html">draw_TrajClusterGrid</a></span><span class="op">(</span>master.list <span class="op">=</span> <span class="va">master.list</span>, min.traj.n <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></code></pre></div>
<p><img src="Gene-Trajectory-Analysis_files/figure-html/unnamed-chunk-6-1.png" width="960"></p>
</div>
<div class="section level4">
<h4 id="plot-gene-trajectory-composition-">6. Plot Gene Trajectory Composition.<a class="anchor" aria-label="anchor" href="#plot-gene-trajectory-composition-"></a>
</h4>
<p>Use hierarchical pie chart to visualize gene trajectory master-pattern and sub-pattern composition. This is useful when comparing two or more projects.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#par(mar=c(1,1,1,1))</span></span>
<span><span class="co">#draw_TrajClusterPie(master.list = master.list,inner.radius = 0.7, cex.out = 1, cex.in = 1, fig.title = "Hierarchical Pie Chart")</span></span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Xinge Wang.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.5.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
